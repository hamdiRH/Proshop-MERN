{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\uzuma\\\\Desktop\\\\hamdiRH\\\\proshop mern\\\\frontend\\\\src\\\\containers\\\\PlaceOrder.js\";\nimport React, { useEffect } from 'react';\nimport _ from 'lodash';\nimport { Link, useHistory } from 'react-router-dom';\nimport { Button, Row, Col, ListGroup, Image, Card, ListGroupItem } from 'react-bootstrap';\nimport PropTypes from 'prop-types';\nimport { Helmet } from 'react-helmet';\nimport { useDispatch, useSelector } from 'react-redux';\nimport Message from '../components/Message';\nimport CheckoutSteps from '../components/CheckoutSteps';\nimport { selectShippingCartAdress, selectPaymentMethod, selectCartItemsData, selectCartItemsLoading, selectCartItemsError } from '../redux/cart/selectors';\nimport { selectOrderData, selectSuccessOrder, selectLoadingOrder, selectErrorOrder } from '../redux/order/selectors';\nimport { createOrder } from '../redux/order/actions';\nimport Cart from './Cart';\n\nconst PlaceOrder = props => {\n  const shippingAddress = useSelector(selectShippingCartAdress) || {};\n  const paymentMethodSelector = useSelector(selectPaymentMethod) || 'Paypal';\n  const cartItems = useSelector(selectCartItemsData);\n  const history = useHistory();\n  const order = useSelector(selectOrderData);\n  const successOrder = useSelector(selectSuccessOrder);\n  const errorOrder = useSelector(selectErrorOrder);\n  const loadingOrder = useSelector(selectLoadingOrder);\n  const dispatch = useDispatch(); //   Caculate Prices\n\n  const addDecimals = num => (Math.round(num * 100) / 100).toFixed(2);\n\n  const itemsPrice = addDecimals(cartItems.reduce((acc, item) => acc + item.price * item.qty, 0));\n  const ShippingPrice = addDecimals(itemsPrice > 100 ? 0 : 100);\n  const taxPrice = addDecimals(Number(0.15 * itemsPrice));\n  const totalPrice = addDecimals(Number(itemsPrice) + Number(ShippingPrice) + Number(taxPrice));\n  useEffect(() => {\n    if (successOrder) {\n      history.push(`order/${order._id}`);\n    }\n  }, [history, successOrder]);\n\n  const placeOrderHandler = () => {\n    dispatch(createOrder({\n      orderItems: cartItems,\n      shippingAddress: shippingAddress,\n      paymentMethod: paymentMethodSelector,\n      itemsPrice,\n      ShippingPrice,\n      taxPrice,\n      totalPrice\n    }));\n  };\n\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(Helmet, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 75,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"title\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 9\n    }\n  }, \"Proshop\"), /*#__PURE__*/React.createElement(\"meta\", {\n    name: \"description\",\n    content: \"Place Order page\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 77,\n      columnNumber: 9\n    }\n  })), /*#__PURE__*/React.createElement(CheckoutSteps, {\n    step1: true,\n    step2: true,\n    step3: true,\n    step4: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 79,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(Row, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Col, {\n    md: 8,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(ListGroup, {\n    variant: \"flush\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 82,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(ListGroup.Item, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"h2\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 84,\n      columnNumber: 15\n    }\n  }, \"Shipping\"), /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 85,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"strong\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 86,\n      columnNumber: 17\n    }\n  }, \"Adress:\"), shippingAddress.address, \", \", shippingAddress.city, \" -\", ' ', shippingAddress.postalCode, \" \", shippingAddress.country)), /*#__PURE__*/React.createElement(ListGroup.Item, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"h2\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 15\n    }\n  }, \"Payment Method\"), /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 93,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"strong\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 17\n    }\n  }, \"Method: \"), paymentMethodSelector)), /*#__PURE__*/React.createElement(ListGroup.Item, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 98,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"h2\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 15\n    }\n  }, \"Order Items\"), _.isEmpty(cartItems) ? /*#__PURE__*/React.createElement(Message, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 101,\n      columnNumber: 17\n    }\n  }, \"Your cart is empty\") : /*#__PURE__*/React.createElement(ListGroup, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 103,\n      columnNumber: 17\n    }\n  }, cartItems.map(item => /*#__PURE__*/React.createElement(ListGroup.Item, {\n    key: item.product,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 105,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(Row, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 106,\n      columnNumber: 23\n    }\n  }, /*#__PURE__*/React.createElement(Col, {\n    md: 2,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 107,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(Image, {\n    src: item.image,\n    alt: item.name,\n    fluid: true,\n    rounded: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 108,\n      columnNumber: 27\n    }\n  })), /*#__PURE__*/React.createElement(Col, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 115,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(Link, {\n    to: `/product/${item.product}`,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 116,\n      columnNumber: 27\n    }\n  }), item.name), /*#__PURE__*/React.createElement(Col, {\n    md: 5,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 119,\n      columnNumber: 25\n    }\n  }, item.qty, \" x $\", item.price, \" = $\", (item.qty * item.price).toFixed(2))))))))), /*#__PURE__*/React.createElement(Col, {\n    md: 4,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 131,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Card, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 132,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(ListGroup, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 133,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(ListGroup.Item, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 134,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"h2\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 135,\n      columnNumber: 17\n    }\n  }, \"Order Summary\")), /*#__PURE__*/React.createElement(ListGroup.Item, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 137,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(Row, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 138,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(Col, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 139,\n      columnNumber: 19\n    }\n  }, \"Items\"), /*#__PURE__*/React.createElement(Col, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 140,\n      columnNumber: 19\n    }\n  }, \"$\", itemsPrice))), /*#__PURE__*/React.createElement(ListGroup.Item, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 143,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(Row, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 144,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(Col, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 145,\n      columnNumber: 19\n    }\n  }, \"Shipping\"), /*#__PURE__*/React.createElement(Col, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 146,\n      columnNumber: 19\n    }\n  }, \"$\", ShippingPrice))), /*#__PURE__*/React.createElement(ListGroup.Item, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 149,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(Row, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 150,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(Col, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 151,\n      columnNumber: 19\n    }\n  }, \"Tax\"), /*#__PURE__*/React.createElement(Col, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 152,\n      columnNumber: 19\n    }\n  }, \"$\", taxPrice))), /*#__PURE__*/React.createElement(ListGroup.Item, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 155,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(Row, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 156,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(Col, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 157,\n      columnNumber: 19\n    }\n  }, \"Total\"), /*#__PURE__*/React.createElement(Col, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 158,\n      columnNumber: 19\n    }\n  }, \"$\", totalPrice))), /*#__PURE__*/React.createElement(ListGroup.Item, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 161,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(Button, {\n    type: \"button\",\n    className: \"btn-block\",\n    disabled: _.isEmpty(cartItems),\n    onClick: placeOrderHandler,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 162,\n      columnNumber: 17\n    }\n  }, \"Place Order\")))))));\n};\n\nPlaceOrder.propTypes = {};\nexport default PlaceOrder;","map":{"version":3,"sources":["C:/Users/uzuma/Desktop/hamdiRH/proshop mern/frontend/src/containers/PlaceOrder.js"],"names":["React","useEffect","_","Link","useHistory","Button","Row","Col","ListGroup","Image","Card","ListGroupItem","PropTypes","Helmet","useDispatch","useSelector","Message","CheckoutSteps","selectShippingCartAdress","selectPaymentMethod","selectCartItemsData","selectCartItemsLoading","selectCartItemsError","selectOrderData","selectSuccessOrder","selectLoadingOrder","selectErrorOrder","createOrder","Cart","PlaceOrder","props","shippingAddress","paymentMethodSelector","cartItems","history","order","successOrder","errorOrder","loadingOrder","dispatch","addDecimals","num","Math","round","toFixed","itemsPrice","reduce","acc","item","price","qty","ShippingPrice","taxPrice","Number","totalPrice","push","_id","placeOrderHandler","orderItems","paymentMethod","address","city","postalCode","country","isEmpty","map","product","image","name","propTypes"],"mappings":"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","sourcesContent":["import React, { useEffect } from 'react';\r\nimport _ from 'lodash';\r\nimport { Link, useHistory } from 'react-router-dom';\r\nimport {\r\n  Button,\r\n  Row,\r\n  Col,\r\n  ListGroup,\r\n  Image,\r\n  Card,\r\n  ListGroupItem,\r\n} from 'react-bootstrap';\r\nimport PropTypes from 'prop-types';\r\nimport { Helmet } from 'react-helmet';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport Message from '../components/Message';\r\nimport CheckoutSteps from '../components/CheckoutSteps';\r\nimport {\r\n  selectShippingCartAdress,\r\n  selectPaymentMethod,\r\n  selectCartItemsData,\r\n  selectCartItemsLoading,\r\n  selectCartItemsError,\r\n} from '../redux/cart/selectors';\r\nimport {\r\n  selectOrderData,\r\n  selectSuccessOrder,\r\n  selectLoadingOrder,\r\n  selectErrorOrder,\r\n} from '../redux/order/selectors';\r\nimport { createOrder } from '../redux/order/actions';\r\nimport Cart from './Cart';\r\n\r\nconst PlaceOrder = (props) => {\r\n  const shippingAddress = useSelector(selectShippingCartAdress) || {};\r\n  const paymentMethodSelector = useSelector(selectPaymentMethod) || 'Paypal';\r\n  const cartItems = useSelector(selectCartItemsData);\r\n  const history = useHistory();\r\n  const order = useSelector(selectOrderData);\r\n  const successOrder = useSelector(selectSuccessOrder);\r\n  const errorOrder = useSelector(selectErrorOrder);\r\n  const loadingOrder = useSelector(selectLoadingOrder);\r\n\r\n  const dispatch = useDispatch();\r\n  //   Caculate Prices\r\n  const addDecimals = (num) => (Math.round(num * 100) / 100).toFixed(2);\r\n  const itemsPrice = addDecimals(\r\n    cartItems.reduce((acc, item) => acc + item.price * item.qty, 0),\r\n  );\r\n  const ShippingPrice = addDecimals(itemsPrice > 100 ? 0 : 100);\r\n  const taxPrice = addDecimals(Number(0.15 * itemsPrice));\r\n  const totalPrice = addDecimals(\r\n    Number(itemsPrice) + Number(ShippingPrice) + Number(taxPrice),\r\n  );\r\n  useEffect(() => {\r\n    if (successOrder) {\r\n      history.push(`order/${order._id}`)\r\n    }\r\n  }, [history, successOrder]);\r\n  const placeOrderHandler = () => {\r\n    dispatch(\r\n      createOrder({\r\n        orderItems: cartItems,\r\n        shippingAddress: shippingAddress,\r\n        paymentMethod: paymentMethodSelector,\r\n        itemsPrice,\r\n        ShippingPrice,\r\n        taxPrice,\r\n        totalPrice,\r\n      }),\r\n    );\r\n  };\r\n  return (\r\n    <>\r\n      <Helmet>\r\n        <title>Proshop</title>\r\n        <meta name=\"description\" content=\"Place Order page\" />\r\n      </Helmet>\r\n      <CheckoutSteps step1 step2 step3 step4 />\r\n      <Row>\r\n        <Col md={8}>\r\n          <ListGroup variant=\"flush\">\r\n            <ListGroup.Item>\r\n              <h2>Shipping</h2>\r\n              <p>\r\n                <strong>Adress:</strong>\r\n                {shippingAddress.address}, {shippingAddress.city} -{' '}\r\n                {shippingAddress.postalCode} {shippingAddress.country}\r\n              </p>\r\n            </ListGroup.Item>\r\n            <ListGroup.Item>\r\n              <h2>Payment Method</h2>\r\n              <p>\r\n                <strong>Method: </strong>\r\n                {paymentMethodSelector}\r\n              </p>\r\n            </ListGroup.Item>\r\n            <ListGroup.Item>\r\n              <h2>Order Items</h2>\r\n              {_.isEmpty(cartItems) ? (\r\n                <Message>Your cart is empty</Message>\r\n              ) : (\r\n                <ListGroup>\r\n                  {cartItems.map((item) => (\r\n                    <ListGroup.Item key={item.product}>\r\n                      <Row>\r\n                        <Col md={2}>\r\n                          <Image\r\n                            src={item.image}\r\n                            alt={item.name}\r\n                            fluid\r\n                            rounded\r\n                          />\r\n                        </Col>\r\n                        <Col>\r\n                          <Link to={`/product/${item.product}`}></Link>\r\n                          {item.name}\r\n                        </Col>\r\n                        <Col md={5}>\r\n                          {item.qty} x ${item.price} = $\r\n                          {(item.qty * item.price).toFixed(2)}\r\n                        </Col>\r\n                      </Row>\r\n                    </ListGroup.Item>\r\n                  ))}\r\n                </ListGroup>\r\n              )}\r\n            </ListGroup.Item>\r\n          </ListGroup>\r\n        </Col>\r\n        <Col md={4}>\r\n          <Card>\r\n            <ListGroup>\r\n              <ListGroup.Item>\r\n                <h2>Order Summary</h2>\r\n              </ListGroup.Item>\r\n              <ListGroup.Item>\r\n                <Row>\r\n                  <Col>Items</Col>\r\n                  <Col>${itemsPrice}</Col>\r\n                </Row>\r\n              </ListGroup.Item>\r\n              <ListGroup.Item>\r\n                <Row>\r\n                  <Col>Shipping</Col>\r\n                  <Col>${ShippingPrice}</Col>\r\n                </Row>\r\n              </ListGroup.Item>\r\n              <ListGroup.Item>\r\n                <Row>\r\n                  <Col>Tax</Col>\r\n                  <Col>${taxPrice}</Col>\r\n                </Row>\r\n              </ListGroup.Item>\r\n              <ListGroup.Item>\r\n                <Row>\r\n                  <Col>Total</Col>\r\n                  <Col>${totalPrice}</Col>\r\n                </Row>\r\n              </ListGroup.Item>\r\n              <ListGroup.Item>\r\n                <Button\r\n                  type=\"button\"\r\n                  className=\"btn-block\"\r\n                  disabled={_.isEmpty(cartItems)}\r\n                  onClick={placeOrderHandler}\r\n                >\r\n                  Place Order\r\n                </Button>\r\n              </ListGroup.Item>\r\n            </ListGroup>\r\n          </Card>\r\n        </Col>\r\n      </Row>\r\n    </>\r\n  );\r\n};\r\n\r\nPlaceOrder.propTypes = {};\r\n\r\nexport default PlaceOrder;\r\n"]},"metadata":{},"sourceType":"module"}